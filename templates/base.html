<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Jones's Pharmacy System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      :root{
        --primary-blue: #0ea5e9; /* sky-500 */
        --accent-green: #16a34a; /* green-600 */
        --danger-red: #ef4444; /* red-500 */
        --glass-white: rgba(255,255,255,0.75);
        --glass-border: rgba(255,255,255,0.6);
        --muted: rgba(0,0,0,0.6);
      }
      html,body{height:100%;}
      body {
        background: linear-gradient(135deg, rgba(14,165,233,0.12) 0%, rgba(16,185,129,0.06) 40%, rgba(239,68,68,0.04) 100%),
                    radial-gradient( circle at 10% 20%, rgba(14,165,233,0.06), transparent 20%),
                    linear-gradient(120deg, #f8fafc 0%, #eaf2ff 100%);
        min-height: 100vh;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
        color: #0f172a;
      }
      .navbar {
        background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
        backdrop-filter: blur(6px) saturate(120%);
        border-bottom: 1px solid rgba(255,255,255,0.06);
        box-shadow: 0 6px 30px rgba(2,6,23,0.12);
        font-size: 1.05rem;
      }
      .navbar-brand {
        font-weight: 800;
        letter-spacing: 1px;
        font-size: 1.25rem;
        color: var(--primary-blue) !important;
      }
      .navbar-nav .nav-link {
        color: var(--muted) !important;
        border-radius: 8px;
        transition: background 0.18s, color 0.18s, transform 0.12s;
        padding: 0.45rem 0.85rem;
        margin: 0 0.18rem;
      }
      .navbar-nav .nav-link:hover, .navbar-nav .nav-link.active {
        background: var(--glass-white) !important;
        color: #071233 !important;
        transform: translateY(-1px);
      }
      .container {
        background: linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.5));
        border-radius: 14px;
        box-shadow: 0 10px 40px rgba(2,6,23,0.08);
        padding: 2rem;
        margin: 2rem auto;
        max-width: 1024px;
        border: 1px solid var(--glass-border);
        backdrop-filter: blur(8px) saturate(120%);
      }
      .alert {
        border-radius: 10px;
        font-size: 1.02rem;
        box-shadow: 0 8px 30px rgba(2,6,23,0.06);
        background: rgba(255,255,255,0.85);
      }
      /* Buttons */
      .btn-primary{background:var(--primary-blue);border-color:transparent;color:#fff}
      .btn-primary:hover{filter:brightness(1.03)}
      .btn-success{background:var(--accent-green);border-color:transparent;color:#fff}
      .btn-danger{background:var(--danger-red);border-color:transparent;color:#fff}
      .btn-outline-light{color:#fff;border-color:rgba(255,255,255,0.18)}
      .btn-info{background:linear-gradient(90deg,var(--primary-blue),#60a5fa);color:#fff}
      .btn-sm{padding:.25rem .5rem;font-size:.85rem}

      /* table contrast */
      table{background:transparent}
      .table-striped>tbody>tr:nth-of-type(odd){background:rgba(15,23,42,0.02)}

      /* badges */
      .badge{border-radius:6px;padding:.35em .55em}
      .badge.bg-warning{background:#fde68a;color:#452c00}
      .badge.bg-danger{background:#fecaca;color:#7f1d1d}

      /* Custom clock styling */
      #clock-date, #clock-time, #clock-zone {
        font-family: 'Fira Mono', 'Consolas', monospace;
        font-size: 0.98rem;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4 shadow-sm">
      <div class="container-fluid">
        <a class="navbar-brand" href="/">Pharmacy Management System</a>
        <div class="collapse navbar-collapse">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item"><a class="nav-link" href="/medicines">Medicines</a></li>
              <li class="nav-item"><a class="nav-link" href="/sales/new">New Sale</a></li>
              <li class="nav-item"><a class="nav-link" href="/customers">Customers</a></li>
              <li class="nav-item"><a class="nav-link" href="/reports">Reports</a></li>
            </ul>
          </div>
          <div class="d-flex align-items-center gap-3 text-light">
            <small>
              <span id="clock-date">{{ current_date }}</span>&nbsp;&nbsp;
              <span id="clock-time">{{ current_time }}</span>
              &nbsp;&nbsp;<small id="clock-zone" class="text-muted"></small>
            </small>
            <a href="{{ url_for('search_sales') }}" class="btn btn-info btn-sm">Search Sales</a>
            {% if session.get('is_admin') %}
              <a href="{{ url_for('admin_logout') }}" class="btn btn-outline-light btn-sm">Logout</a>
            {% else %}
              <a href="{{ url_for('admin_login') }}" class="btn btn-outline-light btn-sm">Admin Login</a>
            {% endif %}
          </div>
      </div>
    </nav>

    <div class="container">
      {% from 'wtf.html' import csrf_token %}
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, msg in messages %}
            <div class="alert alert-{{category}}">{{msg}}</div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      {% block content %}{% endblock %}
    </div>

    <script>
      // Client-side clock: updates every second to show current local date/time
      (function(){
        const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
        function formatTime(d){
          let h = d.getHours();
          const ampm = h >= 12 ? 'PM' : 'AM';
          h = h % 12; if (h === 0) h = 12;
          const m = String(d.getMinutes()).padStart(2,'0');
          const s = String(d.getSeconds()).padStart(2,'0');
          return `${h}:${m}:${s} ${ampm}`;
        }
        function formatDate(d){
          return `${months[d.getMonth()]} ${d.getDate()}, ${d.getFullYear()}`;
        }
        function getTimezoneInfo(d){
          // Try to get the IANA time zone name (may be undefined in some browsers)
          let tz = undefined;
          try{
            tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
          }catch(e){
            tz = undefined;
          }
          // Compute UTC offset in hours and minutes
          const offsetMin = -d.getTimezoneOffset(); // minutes east of UTC
          const sign = offsetMin >= 0 ? '+' : '-';
          const absMin = Math.abs(offsetMin);
          const hours = String(Math.floor(absMin / 60)).padStart(2,'0');
          const mins = String(absMin % 60).padStart(2,'0');
          const offset = `UTC${sign}${hours}:${mins}`;
          return { tz, offset };
        }

        function updateClock(){
          const now = new Date();
          const dateEl = document.getElementById('clock-date');
          const timeEl = document.getElementById('clock-time');
          const zoneEl = document.getElementById('clock-zone');
          if(dateEl) dateEl.textContent = formatDate(now);
          if(timeEl) timeEl.textContent = formatTime(now);
          if(zoneEl){
            const info = getTimezoneInfo(now);
            zoneEl.textContent = info.tz ? `${info.tz} (${info.offset})` : info.offset;
          }
        }
        // update immediately and then every second
        updateClock();
        setInterval(updateClock, 1000);
      })();
    </script>

    <!-- Vercel Speed Insights -->
    <script>
      window.si = window.si || function () { (window.siq = window.siq || []).push(arguments); };
    </script>
    <script defer src="/_vercel/speed-insights/script.js"></script>

  </body>
</html>
